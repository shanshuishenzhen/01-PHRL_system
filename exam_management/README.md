# 考试管理模块 (Exam Management)

## 📝 模块概述

考试管理模块是 PH&RL 在线考试系统的核心功能模块，负责考试的全生命周期管理，包括考试创建、配置、发布、监控和归档等功能。该模块采用Python + Tkinter开发，提供直观的图形界面，支持考试创建、考生分配、状态管理、数据导出等功能，为管理员提供全面的考试管理工具。

## 🎯 主要功能

### 考试管理
- **考试创建**：创建新考试，设置基本信息和参数
- **考试配置**：配置考试时间、参与人员、题目等
- **状态管理**：管理考试的不同状态（草稿、已发布、进行中、已完成、已归档）
- **考试监控**：实时监控考试进行情况
- **结果管理**：查看和管理考试结果
- **分数设置**：设置试卷总分和及格分数/及格百分比

### 考生管理
- **考生分配**：为考试分配参与考生
- **批量导入**：支持从文件批量导入考生名单
- **分组管理**：按部门或其他条件管理考生
- **考生状态**：查看考生的报名和参与状态

### 数据处理
- **数据导出**：导出考试数据和结果
- **统计分析**：基础的考试数据统计
- **数据同步**：与其他模块数据同步
- **数据备份**：考试数据的备份和恢复

## 🔧 技术架构

### 前端技术
- **GUI框架**：Python Tkinter
- **界面组件**：自定义组件和标准控件
- **交互设计**：事件驱动的用户交互
- **样式管理**：统一的主题和样式配置

### 后端技术
- **编程语言**：Python 3.x
- **数据处理**：JSON数据处理
- **业务逻辑**：面向对象的模块设计
- **异常处理**：完善的错误处理机制

### 数据存储
- **文件格式**：JSON格式存储考试数据
- **存储位置**：`exam_management/exams.json`和`exam_management/enrollments.json`
- **数据结构**：包含考试基本信息、配置参数和考生报名关系

### 核心功能
- **状态管理**：自动更新考试状态
- **时间控制**：考试时间自动管理
- **数据同步**：与其他模块数据同步
- **异常处理**：完善的错误处理机制

## 🏗️ 文件结构

```
exam_management/
├── simple_exam_manager.py       # 主程序文件
├── paper_generator.py           # 试卷生成器
├── exams.json                   # 考试数据文件
├── enrollments.json             # 考生报考关系文件
├── answers/                     # 考生答案目录
│   ├── exam_2_student_1_20250625_193448.json  # 考生答案文件示例
│   └── exam_3_student_1_20250625_193454.json  # 考生答案文件示例
├── src/                         # 源代码目录
│   ├── client/                  # 客户端相关代码
│   ├── core/                    # 核心功能代码
│   ├── exam_management/         # 考试管理相关代码
│   ├── grading_center/          # 阅卷中心相关代码
│   ├── question_bank/           # 题库相关代码
│   ├── score_statistics/        # 成绩统计相关代码
│   └── user_management/         # 用户管理相关代码
├── candidate_import_template.txt # 考生导入模板
└── README.md                    # 模块说明文档
```

## 📋 数据字段说明

### 考试基本信息
```json
{
  "id": 1,
  "name": "考试名称",
  "type": "考试类型",
  "status": "考试状态",
  "description": "考试描述",
  "duration_minutes": 120,
  "total_score": 100,
  "pass_score": 60
}
```

### 时间配置
```json
{
  "start_time": "2024-02-01 09:00:00",
  "end_time": "2024-02-01 11:00:00",
  "created_at": "2024-01-15 10:00:00",
  "updated_at": "2024-01-15 10:00:00"
}
```

### 参与配置
```json
{
  "max_participants": 100,
  "current_participants": 0,
  "allowed_departments": ["计算机系", "信息工程系"],
  "created_by": "admin"
}
```

## 🚀 快速开始

### 环境要求
- **Python**：3.6+
- **依赖库**：Tkinter, JSON, datetime
- **操作系统**：Windows, Linux, macOS

### 启动方式

```bash
# 方式1：通过主控台启动（推荐）
python main_console.py
# 然后点击"考试管理"按钮

# 方式2：通过启动器启动
python launcher.py
# 然后选择"考试管理"模块

# 方式3：通过旧版启动器启动
python start_system.py
# 然后点击"考试管理"快速启动按钮

# 方式4：直接启动
python exam_management/simple_exam_manager.py
```

### 使用流程

1. **启动模块**：通过主控台或直接启动考试管理模块
2. **查看列表**：浏览现有考试列表，查看考试状态和基本信息
3. **创建考试**：点击"新增考试"按钮，填写考试基本信息
4. **分配考生**：选择考试，点击"分配考生"按钮，为考试分配参与考生
5. **发布考试**：确认信息无误后，点击"发布考试"按钮
6. **管理考试**：根据考试状态执行开始、结束、查看结果等操作
7. **导出数据**：考试完成后，可导出考试结果和统计数据

## 📊 考试状态说明

| 状态 | 说明 | 可执行操作 |
|------|------|------------|
| **草稿** | 考试已创建但未发布 | 编辑、发布、删除 |
| **已发布** | 考试已发布但未开始 | 开始考试、编辑、取消发布 |
| **进行中** | 考试正在进行 | 结束考试、查看统计 |
| **已完成** | 考试已结束 | 查看成绩、归档 |
| **已归档** | 考试已归档 | 查看历史、恢复 |

## 🎨 界面特色

### 设计理念
- **简洁醒目**：界面设计简洁明了，重要功能突出显示
- **操作简单**：功能操作流程简单直观，降低学习成本
- **视觉统一**：采用统一的颜色主题和设计风格
- **响应式布局**：支持窗口大小调整，适配不同屏幕

### 界面组件
- 🎨 **现代化卡片式布局**：清晰的信息层次
- 🎯 **彩色图标按钮**：功能一目了然
- 📊 **实时状态显示**：考试状态实时更新
- 🔄 **动态时间显示**：考试时间倒计时
- 📖 **详细信息面板**：考试详情完整展示

## 🔄 模块集成

### 与其他模块的关系
- **题库管理**：选择考试题目和题库
- **用户管理**：管理考试参与人员
- **客户机端**：提供考试答题界面
- **成绩统计**：分析考试成绩数据
- **阅卷中心**：处理考试评分工作

### 数据流向
```
题库管理 → 考试管理 → 客户机端 → 阅卷中心 → 成绩统计
    ↓           ↓           ↓           ↓           ↓
  题目数据    考试配置    答题数据    评分数据    统计报告
```

## 🚀 使用指南

### 核心操作流程

1. **创建考试**：点击"➕ 新增考试"，填写考试基本信息，创建一场新考试。初始状态为"草稿"。
2. **分配考生**：
   * 在左侧列表中选中一场考试。
   * 右侧详情区域会出现"👥 分配考生"按钮。
   * 点击按钮，在弹出的窗口中，从左侧"可选考生"列表选择考生，点击 `>>` 按钮将其移动到右侧"已选考生"列表。
   * 点击"保存"完成分配。
3. **编辑考试**：选中"草稿"状态的考试，点击"✏️ 编辑考试"或详情区的按钮进行修改。
3. **考试设置**：
   * 在考试列表中选择一个考试
   * 点击"设置"按钮
   * 在设置界面中配置考试参数
   * 设置试卷总分和及格分数/及格百分比
   * 点击"保存"按钮保存设置
4. **发布考试**：确认信息无误后，点击"📢 发布考试"，此时考生将能看到该考试。
5. **开始/结束考试**：在预定时间，系统会自动将"已发布"的考试切换为"进行中"，将"进行中"的切换为"已完成"。您也可以手动点击按钮强制开始或结束。
6. **查看结果与归档**：考试完成后，可以查看统计信息和成绩，并将其"📁 归档"。

### 批量报考处理

系统支持强大的批量报考处理功能，允许您高效地为某场考试分配考生。

#### 操作步骤

1. 在考试列表中，选中一场考试
2. 点击**分配考生**按钮，打开"批量报考处理中心"窗口
3. 使用界面功能选择考生
4. 完成所有考生分配后，点击**保存**按钮，系统将保存本次的报考关系

#### 功能介绍

该中心分为三个主要区域：**可选考生**、**控制按钮**和**已选考生**。

**可选考生区域**:
- **搜索框**: 输入考生的姓名、用户名(学号)或身份证号(ID)进行即时搜索
- **部门筛选**: 通过下拉菜单选择部门，只显示该部门下的可选考生
- **筛选按钮**: 应用搜索和筛选条件
- **从文件导入**: 
  - 支持导入`.txt`或`.csv`文件，每行包含一个考生的用户名或身份证号
  - 提供模板`candidate_import_template.txt`供参考
  - 自动将找到的未报名考生移动到"已选考生"列表
  - 显示导入成功人数和未找到的标识符
- **列表**: 显示所有符合筛选条件的未报名考生

**控制按钮**:
- `>`: 将左侧列表中**选中**的考生移动到右侧
- `>>`: 将左侧列表中**所有可见**的考生全部移动到右侧
- `<`: 将右侧列表中**选中**的考生移回到左侧
- `<<`: 将右侧列表中**所有**考生全部移回到左侧

**已选考生区域**:
- 显示已报名参加本次考试的所有考生
- 顶部实时显示已选的总人数

## 🐛 问题排查

### 常见问题

1. **考试状态不更新**
   - 检查系统时间是否正确
   - 确认考试时间配置
   - 查看状态更新线程是否正常运行

2. **数据保存失败**
   - 检查文件权限
   - 确认磁盘空间
   - 查看JSON格式是否正确

3. **界面显示异常**
   - 检查字体支持
   - 确认屏幕分辨率
   - 尝试调整窗口大小

### 调试方法

1. **查看日志**：检查控制台输出信息
2. **数据验证**：检查JSON文件格式
3. **状态检查**：验证考试状态逻辑
4. **时间同步**：确认系统时间准确性

## 🔄 版本历史

### v1.0.0 (2024-01-15)
- ✅ 完成基础考试管理功能
- ✅ 实现考试状态自动管理
- ✅ 添加考生分配功能
- ✅ 实现考试数据导出

### v1.0.1 (2024-06-29)
- ✅ 将"编辑考试"下拉列表中的英文考试类型改为中文显示
- ✅ 优化考试类型在编辑和保存时的中英文转换逻辑

### v1.1.0 (计划中)
- 🔄 添加高级考试配置功能
- 🔄 增强考试监控能力
- 🔄 优化用户界面体验
- 🔄 添加更多数据分析功能

## 📞 技术支持

如有使用问题或建议，请联系：
- 邮箱：support@phrl-exam.com
- 电话：400-123-4567
- 工作时间：周一至周五 9:00-18:00

---

**考试管理模块** - 让考试管理更简单、更高效！
